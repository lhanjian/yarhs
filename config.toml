[server]
host = "127.0.0.1"
port = 8080
api_host = "0.0.0.0"  # API server listen address
api_port = 8000       # API management port (independent from main server port)
workers = 4           # Tokio runtime worker threads (default: CPU core count)

[logging]
level = "debug"
access_log = false
show_headers = false

[performance]
keep_alive_timeout = 75
read_timeout = 30
write_timeout = 30
max_connections = 5000

[http]
server_name = "Tokio-Hyper/1.0"
default_content_type = "text/html; charset=utf-8"
enable_cors = false
max_body_size = 10485760  # 10MB (HTTP request body size limit)

[routes]
index_files = ["index.html", "index.htm"]  # Default documents

# Static directory mapping (unified configuration)
[routes.custom_routes]
"/static" = { type = "dir", path = "static" }
"/about" = { type = "file", path = "templates/about.html" }
"/home" = { type = "file", path = "templates/index.html" }

# More route examples (optional)
# "/old-path" = { type = "redirect", target = "/new-path" }
# "/uploads" = { type = "static", dir = "user_uploads" }

# ============================================
# Virtual Hosts Configuration (xDS-compatible)
# ============================================
# When virtual_hosts is configured, requests are routed based on Host header.
# If empty or not configured, falls back to [routes] above.
#
# Example configuration:
# [[virtual_hosts]]
# name = "api-site"
# domains = ["api.example.com", "api.localhost"]
# 
# [[virtual_hosts.routes]]
# name = "api-root"
# match = { prefix = "/" }
# type = "dir"
# path = "/var/www/api"
# 
# [[virtual_hosts]]
# name = "www-site"
# domains = ["www.example.com", "*.example.com"]
# index_files = ["index.html", "home.html"]
# 
# [[virtual_hosts.routes]]
# name = "static-assets"
# match = { prefix = "/assets" }
# type = "dir"
# path = "static"
# 
# [[virtual_hosts.routes]]
# name = "www-root"
# match = { prefix = "/" }
# type = "dir"
# path = "/var/www/html"
#
# [[virtual_hosts]]
# name = "catch-all"
# domains = ["*"]
# 
# [[virtual_hosts.routes]]
# name = "default"
# match = { prefix = "/" }
# type = "direct"
# status = 404
# body = "Unknown host"
